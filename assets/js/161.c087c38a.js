(window.webpackJsonp=window.webpackJsonp||[]).push([[161],{1229:function(t,e,a){"use strict";a.r(e);var s=a(19),v=Object(s.a)({},function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[s("h1",{attrs:{id:"键盘：keydown-和-keyup"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#键盘：keydown-和-keyup","aria-hidden":"true"}},[t._v("#")]),t._v(" 键盘：keydown 和 keyup")]),t._v(" "),s("p",[t._v("在我们开始学习键盘的相关内容之前，请注意，在现代设备上，还有其他“输入内容”的方法。例如，人们使用语音识别（尤其是在移动端设备上）或用鼠标复制/粘贴。")]),t._v(" "),s("p",[t._v("因此，如果我们想要跟踪 "),s("code",[t._v("<input>")]),t._v(" 字段中的所有输入，那么键盘事件是不够的。无论如何，还需要一个名为 "),s("code",[t._v("input")]),t._v(" 的事件来跟踪 "),s("code",[t._v("<input>")]),t._v(" 字段中的更改。对于这样的任务来说，这可能是一个更好的选择。稍后我们将在 "),s("router-link",{attrs:{to:"/learn_javascript_asdiasdkc/two/yyuvnqzasdias/03/"}},[t._v("事件：change，input，cut，copy，paste")]),t._v(" 一章中介绍它们。")],1),t._v(" "),s("p",[t._v("当我们想要处理键盘行为时，应该使用键盘事件（虚拟键盘也算）。例如，对方向键 "),s("kbd",[t._v("Up")]),t._v(" 和 "),s("kbd",[t._v("Down")]),t._v(" 或热键（包括按键的组合）作出反应。")]),t._v(" "),s("br"),t._v(" "),s("br"),t._v(" "),s("br"),t._v(" "),s("h2",{attrs:{id:"测试台"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#测试台","aria-hidden":"true"}},[t._v("#")]),t._v(" 测试台")]),t._v(" "),s("p",[t._v("为了更好地理解键盘事件，你可以使用下面这个测试台。")]),t._v(" "),s("p",[t._v("在文本区域中尝试使用不同的组合键。")]),t._v(" "),s("ClientOnly",[s("learn_javascript_asdiasdkc-two-kodmnvxcnaq-05-demo1")],1),t._v(" "),s("br"),t._v(" "),s("br"),t._v(" "),s("br"),t._v(" "),s("h2",{attrs:{id:"keydown-和-keyup"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#keydown-和-keyup","aria-hidden":"true"}},[t._v("#")]),t._v(" Keydown 和 keyup")]),t._v(" "),s("p",[t._v("当一个按键被按下时，会触发 "),s("code",[t._v("keydown")]),t._v(" 事件，而当按键被释放时，会触发 "),s("code",[t._v("keyup")]),t._v(" 事件。")]),t._v(" "),s("br"),t._v(" "),s("br"),t._v(" "),s("h3",{attrs:{id:"event-code-和-event-key"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#event-code-和-event-key","aria-hidden":"true"}},[t._v("#")]),t._v(" event.code 和 event.key")]),t._v(" "),s("p",[t._v("事件对象的 "),s("code",[t._v("key")]),t._v(" 属性允许获取字符，而事件对象的 "),s("code",[t._v("code")]),t._v(" 属性则允许获取“物理按键代码”。")]),t._v(" "),s("p",[t._v("例如，同一个按键 "),s("kbd",[t._v("Z")]),t._v("，可以与或不与 "),s("code",[t._v("Shift")]),t._v(" 一起按下。我们会得到两个不同的字符：小写的 "),s("code",[t._v("z")]),t._v(" 和大写的 "),s("code",[t._v("Z")]),t._v("。")]),t._v(" "),s("p",[s("code",[t._v("event.key")]),t._v(" 正是这个字符，并且它将是不同的。但是，"),s("code",[t._v("event.code")]),t._v(" 是相同的：")]),t._v(" "),s("table",[s("thead",[s("tr",[s("th",[s("strong",[t._v("Key")])]),t._v(" "),s("th",[s("strong",[s("code",[t._v("event.key")])])]),t._v(" "),s("th",[s("strong",[s("code",[t._v("event.code")])])])])]),t._v(" "),s("tbody",[s("tr",[s("td",[s("kbd",[t._v("Z")])]),t._v(" "),s("td",[s("code",[t._v("z")]),t._v("（小写）")]),t._v(" "),s("td",[s("code",[t._v("KeyZ")])])]),t._v(" "),s("tr",[s("td",[s("kbd",[t._v("Shift+Z")])]),t._v(" "),s("td",[s("code",[t._v("Z")]),t._v("（大写）")]),t._v(" "),s("td",[s("code",[t._v("KeyZ")])])])])]),t._v(" "),s("p",[t._v("如果用户使用不同的语言，那么切换到另一种语言将产生完全不同的字符，而不是 "),s("code",[t._v('"Z"')]),t._v("。它将成为 "),s("code",[t._v("event.key")]),t._v(" 的值，而 "),s("code",[t._v("event.code")]),t._v(" 则始终都是一样的："),s("code",[t._v('"KeyZ"')]),t._v("。")]),t._v(" "),s("br"),t._v(" "),s("div",{staticClass:"tip custom-block"},[s("p",[s("strong",[t._v("“KeyZ” 和其他按键代码")])]),t._v(" "),s("p",[t._v("每个按键的代码都取决于该按键在键盘上的位置。"),s("a",{attrs:{href:"https://www.w3.org/TR/uievents-code/",target:"_blank",rel:"noopener noreferrer"}},[t._v("UI 事件代码规范"),s("OutboundLink")],1),t._v(" 中描述了按键代码。")]),t._v(" "),s("p",[t._v("例如：")]),t._v(" "),s("ul",[s("li",[t._v("字符键的代码为 "),s("code",[t._v('"Key<letter>"')]),t._v("："),s("code",[t._v('"KeyA"')]),t._v("，"),s("code",[t._v('"KeyB"')]),t._v(" 等。")]),t._v(" "),s("li",[t._v("数字键的代码为："),s("code",[t._v('"Digit<number>"')]),t._v("："),s("code",[t._v('"Digit0"')]),t._v("，"),s("code",[t._v('"Digit1"')]),t._v(" 等。")]),t._v(" "),s("li",[t._v("特殊按键的代码为按键的名字："),s("code",[t._v('"Enter"')]),t._v("，"),s("code",[t._v('"Backspace"')]),t._v("，"),s("code",[t._v('"Tab"')]),t._v(" 等。")])]),t._v(" "),s("p",[t._v("有几种广泛应用的键盘布局，该规范给出了每种布局的按键代码。")]),t._v(" "),s("p",[t._v("有关更多按键代码，请参见 "),s("a",{attrs:{href:"https://www.w3.org/TR/uievents-code/#key-alphanumeric-section",target:"_blank",rel:"noopener noreferrer"}},[t._v("规范的字母数字部分"),s("OutboundLink")],1),t._v(" ，或者只需在上面的 "),s("router-link",{attrs:{to:"/learn_javascript_asdiasdkc/two/kodmnvxcnaq/05/#测试台"}},[t._v("测试台")]),t._v(" 中按下一个按键。")],1)]),t._v(" "),s("div",{staticClass:"warning custom-block"},[s("p",[s("strong",[t._v("大小写敏感："),s("code",[t._v('"KeyZ"')]),t._v("，不是 "),s("code",[t._v('"keyZ"')])])]),t._v(" "),s("p",[t._v("这是显而易见的，但人们仍会搞错。")]),t._v(" "),s("p",[t._v("请规避错误类型：它是 "),s("code",[t._v("KeyZ")]),t._v("，而不是 "),s("code",[t._v("keyZ")]),t._v("。像 "),s("code",[t._v('event.code=="keyZ"')]),t._v(" 这样的检查不起作用："),s("code",[t._v('"Key"')]),t._v(" 的首字母必须大写。")])]),t._v(" "),s("br"),t._v(" "),s("p",[t._v("如果按键没有给出任何字符呢？例如，"),s("code",[t._v("Shift")]),t._v(" 或 "),s("code",[t._v("F1")]),t._v(" 或其他。对于这些按键，它们的 "),s("code",[t._v("event.key")]),t._v(" 与 "),s("code",[t._v("event.code")]),t._v(" 大致相同：")]),t._v(" "),s("table",[s("thead",[s("tr",[s("th",[s("strong",[t._v("Key")])]),t._v(" "),s("th",[s("strong",[s("code",[t._v("event.key")])])]),t._v(" "),s("th",[s("strong",[s("code",[t._v("event.code")])])])])]),t._v(" "),s("tbody",[s("tr",[s("td",[s("kbd",[t._v("F1")])]),t._v(" "),s("td",[s("code",[t._v("F1")])]),t._v(" "),s("td",[s("code",[t._v("F1")])])]),t._v(" "),s("tr",[s("td",[s("kbd",[t._v("Backspace")])]),t._v(" "),s("td",[s("code",[t._v("Backspace")])]),t._v(" "),s("td",[s("code",[t._v("Backspace")])])]),t._v(" "),s("tr",[s("td",[s("kbd",[t._v("Shift")])]),t._v(" "),s("td",[s("code",[t._v("Shift")])]),t._v(" "),s("td",[s("code",[t._v("ShiftRight")]),t._v(" 或 "),s("code",[t._v("ShiftLeft")])])])])]),t._v(" "),s("p",[t._v("请注意，"),s("code",[t._v("event.code")]),t._v(" 准确地标明了哪个键被按下了。例如，大多数键盘有两个 "),s("code",[t._v("Shift")]),t._v(" 键，一个在左边，一个在右边。"),s("code",[t._v("event.code")]),t._v(" 会准确地告诉我们按下了哪个键，而 "),s("code",[t._v("event.key")]),t._v(" 对按键的“含义”负责：它是什么（一个 “Shift”）。")]),t._v(" "),s("p",[t._v("假设，我们要处理一个热键："),s("kbd",[t._v("Ctrl+Z")]),t._v("（或 Mac 上的 "),s("kbd",[t._v("Cmd+Z")]),t._v("）。大多数文本编辑器将“撤销”行为挂在其上。我们可以在 "),s("code",[t._v("keydown")]),t._v(" 上设置一个监听器，并检查哪个键被按下了。")]),t._v(" "),s("p",[t._v("这里有个难题：在这样的监听器中，我们应该检查 "),s("code",[t._v("event.key")]),t._v(" 的值还是 "),s("code",[t._v("event.code")]),t._v(" 的值？")]),t._v(" "),s("p",[t._v("一方面，"),s("code",[t._v("event.key")]),t._v(" 的值是一个字符，它随语言而改变。如果访问者在 OS 中使用多种语言，并在它们之间进行切换，那么相同的按键将给出不同的字符。因此检查 "),s("code",[t._v("event.code")]),t._v(" 会更好，因为它总是相同的。")]),t._v(" "),s("p",[t._v("像这样：")]),t._v(" "),s("div",{staticClass:"language-js line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-js"}},[s("code",[t._v("document"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("addEventListener")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'keydown'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("event")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("event"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("code "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("==")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'KeyZ'")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&&")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("event"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("ctrlKey "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("||")]),t._v(" event"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("metaKey"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("alert")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'Undo!'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])]),t._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[t._v("1")]),s("br"),s("span",{staticClass:"line-number"},[t._v("2")]),s("br"),s("span",{staticClass:"line-number"},[t._v("3")]),s("br"),s("span",{staticClass:"line-number"},[t._v("4")]),s("br"),s("span",{staticClass:"line-number"},[t._v("5")]),s("br")])]),s("p",[t._v("另一方面，"),s("code",[t._v("event.code")]),t._v(" 有一个问题。对于不同的键盘布局，相同的按键可能会具有不同的字符。")]),t._v(" "),s("p",[t._v("例如，下面是美式布局（“QWERTY”）和德式布局（“QWERTZ”）—— 来自 Wikipedia：")]),t._v(" "),s("p",[s("img",{attrs:{src:a(648),alt:""}})]),t._v(" "),s("p",[s("img",{attrs:{src:a(649),alt:""}})]),t._v(" "),s("p",[t._v("对于同一个按键，美式布局为 “Z”，而德式布局为 “Y”（字母被替换了）。")]),t._v(" "),s("p",[t._v("从字面上看，对于使用德式布局键盘的人来说，但他们按下 "),s("kbd",[t._v("Y")]),t._v(" 时，"),s("code",[t._v("event.code")]),t._v(" 将等于 "),s("code",[t._v("KeyZ")]),t._v("。")]),t._v(" "),s("p",[t._v("如果我们在代码中检查 "),s("code",[t._v("event.code == 'KeyZ'")]),t._v("，那么对于使用德式布局键盘的人来说，当他们按下 "),s("code",[t._v("Y")]),t._v(" 时，这个测试就通过了。")]),t._v(" "),s("p",[t._v("听起来确实很怪，但事实确实如此。"),s("a",{attrs:{href:"https://www.w3.org/TR/uievents-code/#table-key-code-alphanumeric-writing-system",target:"_blank",rel:"noopener noreferrer"}},[t._v("规范"),s("OutboundLink")],1),t._v(" 中明确提到了这种行为。")]),t._v(" "),s("p",[t._v("因此，"),s("code",[t._v("event.code")]),t._v(" 可能由于意外的键盘布局而与错误的字符进行了匹配。不同键盘布局中的相同字母可能会映射到不同的物理键，从而导致了它们有不同的代码。幸运的是，这种情况只发生在几个代码上，例如 "),s("code",[t._v("keyA")]),t._v("，"),s("code",[t._v("keyQ")]),t._v("，"),s("code",[t._v("keyZ")]),t._v("（我们已经看到了），而对于诸如 "),s("code",[t._v("Shift")]),t._v(" 这样的特殊按键没有发生这种情况。你可以在 "),s("a",{attrs:{href:"https://www.w3.org/TR/uievents-code/#table-key-code-alphanumeric-writing-system",target:"_blank",rel:"noopener noreferrer"}},[t._v("规范"),s("OutboundLink")],1),t._v(" 中找到该列表。")]),t._v(" "),s("p",[t._v("为了可靠地跟踪与受键盘布局影响的字符，使用 "),s("code",[t._v("event.key")]),t._v(" 可能是一个更好的方式。")]),t._v(" "),s("p",[t._v("另一方面，"),s("code",[t._v("event.code")]),t._v(" 的好处是，即使访问者更改了语言，绑定到物理键位置的 "),s("code",[t._v("event.code")]),t._v(" 会始终保持不变。因此，即使在切换了语言的情况下，依赖于它的热键也能正常工作。")]),t._v(" "),s("p",[t._v("我们想要处理与布局有关的按键？那么 "),s("code",[t._v("event.key")]),t._v(" 是我们必选的方式。")]),t._v(" "),s("p",[t._v("或者我们希望一个热键即使在切换了语言后，仍能正常使用？那么 "),s("code",[t._v("event.code")]),t._v(" 可能会更好。")]),t._v(" "),s("br"),t._v(" "),s("br"),t._v(" "),s("br"),t._v(" "),s("h2",{attrs:{id:"自动重复"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#自动重复","aria-hidden":"true"}},[t._v("#")]),t._v(" 自动重复")]),t._v(" "),s("p",[t._v("如果按下一个键足够长的时间，它就会开始“自动重复”："),s("code",[t._v("keydown")]),t._v(" 会被一次又一次地触发，然后当按键被释放时，我们最终会得到 "),s("code",[t._v("keyup")]),t._v("。因此，有很多 "),s("code",[t._v("keydown")]),t._v(" 却只有一个 "),s("code",[t._v("keyup")]),t._v(" 是很正常的。")]),t._v(" "),s("p",[t._v("对于由自动重复触发的事件，"),s("code",[t._v("event")]),t._v(" 对象的 "),s("code",[t._v("event.repeat")]),t._v(" 属性被设置为 "),s("code",[t._v("true")]),t._v("。")]),t._v(" "),s("br"),t._v(" "),s("br"),t._v(" "),s("br"),t._v(" "),s("h2",{attrs:{id:"默认行为"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#默认行为","aria-hidden":"true"}},[t._v("#")]),t._v(" 默认行为")]),t._v(" "),s("p",[t._v("默认行为各不相同，因为键盘可能会启动许多可能的东西。")]),t._v(" "),s("p",[t._v("例如：")]),t._v(" "),s("ul",[s("li",[t._v("出现在屏幕上的一个字符（最明显的结果）。")]),t._v(" "),s("li",[t._v("一个字符被删除（"),s("kbd",[t._v("Delete")]),t._v(" 键）。")]),t._v(" "),s("li",[t._v("滚动页面（"),s("kbd",[t._v("PageDown")]),t._v(" 键）。")]),t._v(" "),s("li",[t._v("浏览器打开“保存页面”对话框（"),s("kbd",[t._v("Ctrl+S")]),t._v("）")]),t._v(" "),s("li",[t._v("……等。")])]),t._v(" "),s("p",[t._v("阻止对 "),s("code",[t._v("keydown")]),t._v(" 的默认行为可以取消大多数的行为，但基于 OS 的特殊按键除外。例如，在 Windows 中，"),s("kbd",[t._v("Alt+F4")]),t._v(" 会关闭当前浏览器窗口。并且无法通过在 JavaScript 中阻止默认行为来阻止它。")]),t._v(" "),s("p",[t._v("例如，下面的这个 "),s("code",[t._v("<input>")]),t._v(" 期望输入的内容为一个电话号码，因此它不会接受除数字，"),s("code",[t._v("+")]),t._v("，"),s("code",[t._v("()")]),t._v(" 和 "),s("code",[t._v("-")]),t._v(" 以外的按键：")]),t._v(" "),s("div",{staticClass:"language-html line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-html"}},[s("code",[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("script")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),s("span",{pre:!0,attrs:{class:"token script"}},[s("span",{pre:!0,attrs:{class:"token language-javascript"}},[t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("checkPhoneKey")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("key")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("key "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'0'")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&&")]),t._v(" key "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'9'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("||")]),t._v(" key "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("==")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'+'")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("||")]),t._v(" key "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("==")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'('")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("||")]),t._v(" key "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("==")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("')'")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("||")]),t._v(" key "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("==")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'-'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])]),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("script")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("input")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("onkeydown")]),s("span",{pre:!0,attrs:{class:"token attr-value"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')]),t._v("return checkPhoneKey(event.key)"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')])]),t._v(" "),s("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("placeholder")]),s("span",{pre:!0,attrs:{class:"token attr-value"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')]),t._v("Phone, please"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')])]),t._v(" "),s("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("type")]),s("span",{pre:!0,attrs:{class:"token attr-value"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')]),t._v("tel"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')])]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n")])]),t._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[t._v("1")]),s("br"),s("span",{staticClass:"line-number"},[t._v("2")]),s("br"),s("span",{staticClass:"line-number"},[t._v("3")]),s("br"),s("span",{staticClass:"line-number"},[t._v("4")]),s("br"),s("span",{staticClass:"line-number"},[t._v("5")]),s("br"),s("span",{staticClass:"line-number"},[t._v("6")]),s("br")])]),s("ClientOnly",[s("learn_javascript_asdiasdkc-two-kodmnvxcnaq-05-mountedDemo")],1),t._v(" "),s("div",{staticClass:"h-b"},[s("input",{attrs:{onkeydown:"return checkPhoneKey5(event.key)",placeholder:"Phone, please",type:"tel"}})]),t._v(" "),s("p",[t._v("请注意，像 "),s("kbd",[t._v("Backspace")]),t._v("，"),s("kbd",[t._v("Left")]),t._v("，"),s("kbd",[t._v("Right")]),t._v("，"),s("kbd",[t._v("Ctrl+V")]),t._v(" 这样的特殊按键在输入中无效。这是严格过滤器 "),s("code",[t._v("checkPhoneKey")]),t._v(" 的副作用。")]),t._v(" "),s("br"),t._v(" "),s("p",[t._v("让我们将过滤条件放松一下：")]),t._v(" "),s("div",{staticClass:"language-html line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-html"}},[s("code",[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("script")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),s("span",{pre:!0,attrs:{class:"token script"}},[s("span",{pre:!0,attrs:{class:"token language-javascript"}},[t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("checkPhoneKey")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("key")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("key "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'0'")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&&")]),t._v(" key "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'9'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("||")]),t._v(" key "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("==")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'+'")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("||")]),t._v(" key "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("==")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'('")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("||")]),t._v(" key "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("==")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("')'")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("||")]),t._v(" key "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("==")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'-'")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("||")]),t._v("\n    key "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("==")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'ArrowLeft'")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("||")]),t._v(" key "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("==")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'ArrowRight'")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("||")]),t._v(" key "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("==")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'Delete'")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("||")]),t._v(" key "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("==")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'Backspace'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])]),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("script")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("input")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("onkeydown")]),s("span",{pre:!0,attrs:{class:"token attr-value"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')]),t._v("return checkPhoneKey(event.key)"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')])]),t._v(" "),s("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("placeholder")]),s("span",{pre:!0,attrs:{class:"token attr-value"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')]),t._v("Phone, please"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')])]),t._v(" "),s("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("type")]),s("span",{pre:!0,attrs:{class:"token attr-value"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')]),t._v("tel"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')])]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n")])]),t._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[t._v("1")]),s("br"),s("span",{staticClass:"line-number"},[t._v("2")]),s("br"),s("span",{staticClass:"line-number"},[t._v("3")]),s("br"),s("span",{staticClass:"line-number"},[t._v("4")]),s("br"),s("span",{staticClass:"line-number"},[t._v("5")]),s("br"),s("span",{staticClass:"line-number"},[t._v("6")]),s("br"),s("span",{staticClass:"line-number"},[t._v("7")]),s("br")])]),s("div",{staticClass:"h-b"},[s("input",{attrs:{onkeydown:"return checkPhoneKey6(event.key)",placeholder:"Phone, please",type:"tel"}})]),t._v(" "),s("p",[t._v("现在方向键和删除键都能正常使用了。")]),t._v(" "),s("p",[t._v("……但我们仍然可以使用鼠标右键单击 + 粘贴来输入任何内容。因此，这个过滤器并不是 100% 可靠。我们可以让它就这样吧，因为大多数情况下它是有效的。或者，另一种方式是跟踪 "),s("code",[t._v("input")]),t._v(" 事件 —— 在任何修改后触发。这样我们就可以检查新值，并在其无效时高亮/修改它。")]),t._v(" "),s("br"),t._v(" "),s("br"),t._v(" "),s("br"),t._v(" "),s("h2",{attrs:{id:"遗存"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#遗存","aria-hidden":"true"}},[t._v("#")]),t._v(" 遗存")]),t._v(" "),s("p",[t._v("过去曾经有一个 "),s("code",[t._v("keypress")]),t._v(" 事件，还有事件对象的 "),s("code",[t._v("keyCode")]),t._v("、"),s("code",[t._v("charCode")]),t._v(" 和 "),s("code",[t._v("which")]),t._v(" 属性。")]),t._v(" "),s("p",[t._v("大多数浏览器对它们都存在兼容性问题，以致使该规范的开发者不得不弃用它们并创建新的现代的事件（本文上面所讲的这些事件），除此之外别无选择。旧的代码仍然有效，因为浏览器还在支持它们，但现在完全没必要再使用它们。")]),t._v(" "),s("br"),t._v(" "),s("br"),t._v(" "),s("br"),t._v(" "),s("h2",{attrs:{id:"总结"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#总结","aria-hidden":"true"}},[t._v("#")]),t._v(" 总结")]),t._v(" "),s("p",[t._v("按一个按键总是会产生一个键盘事件，无论是符号键，还是例如 "),s("kbd",[t._v("Shift")]),t._v(" 或 "),s("kbd",[t._v("Ctrl")]),t._v(" 等特殊按键。唯一的例外是有时会出现在笔记本电脑的键盘上的 "),s("kbd",[t._v("Fn")]),t._v(" 键。它没有键盘事件，因为它通常是被在比 OS 更低的级别上实现的。")]),t._v(" "),s("p",[t._v("键盘事件：")]),t._v(" "),s("ul",[s("li",[s("code",[t._v("keydown")]),t._v(" —— 在按下键时（如果长按按键，则将自动重复），")]),t._v(" "),s("li",[s("code",[t._v("keyup")]),t._v(" —— 释放按键时。")])]),t._v(" "),s("p",[t._v("键盘事件的主要属性：")]),t._v(" "),s("ul",[s("li",[s("code",[t._v("code")]),t._v(" —— “按键代码”（"),s("code",[t._v('"KeyA"')]),t._v("，"),s("code",[t._v('"ArrowLeft"')]),t._v(" 等），特定于键盘上按键的物理位置。")]),t._v(" "),s("li",[s("code",[t._v("key")]),t._v(" —— 字符（"),s("code",[t._v('"A"')]),t._v("，"),s("code",[t._v('"a"')]),t._v(" 等），对于非字符（non-character）的按键，通常具有与 "),s("code",[t._v("code")]),t._v(" 相同的值。")])]),t._v(" "),s("p",[t._v("过去，键盘事件有时会被用于跟踪表单字段中的用户输入。这并不可靠，因为输入可能来自各种来源。我们有 "),s("code",[t._v("input")]),t._v(" 和 "),s("code",[t._v("change")]),t._v(" 事件来处理任何输入（稍后我们会在 "),s("router-link",{attrs:{to:"/learn_javascript_asdiasdkc/two/yyuvnqzasdias/03/"}},[t._v("事件：change，input，cut，copy，paste")]),t._v(" 一章中进行介绍）。它们在任何类型的输入（包括复制粘贴或语音识别）后触发。")],1),t._v(" "),s("p",[t._v("当我们真的想要键盘时，我们应该使用键盘事件。例如，对热键或特殊键作出反应。")]),t._v(" "),s("br"),t._v(" "),s("br"),t._v(" "),s("br")],1)},[],!1,null,null,null);e.default=v.exports},648:function(t,e,a){t.exports=a.p+"assets/img/us-layout.0a8540bd.svg"},649:function(t,e,a){t.exports=a.p+"assets/img/german-layout.90f64b38.svg"}}]);